
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="http://yihui.name/media/js/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="http://yihui.name/knitr"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.10.5</code>)
    .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">setwd</span><span class="hl std">(</span><span class="hl str">'/home/fortelny/OtherAnalysis/2015_07_03_mRNAvsProtein/DraftMapOfHumanProteome/final'</span><span class="hl std">)</span>

<span class="hl kwd">library</span><span class="hl std">(gdata)</span>
</pre></div>
<div class="message"><pre class="knitr r">## gdata: read.xls support for 'XLS' (Excel 97-2004) files ENABLED.
## 
## gdata: Unable to load perl libaries needed by read.xls()
## gdata: to support 'XLSX' (Excel 2007+) files.
## 
## gdata: Run the function 'installXLSXsupport()'
## gdata: to automatically download and install the perl
## gdata: libaries needed to support Excel XLS and XLSX formats.
## 
## Attaching package: 'gdata'
## 
## The following object is masked from 'package:stats':
## 
##     nobs
## 
## The following object is masked from 'package:utils':
## 
##     object.size
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(ggplot2)</span>
<span class="hl kwd">library</span><span class="hl std">(reshape)</span>
<span class="hl kwd">library</span><span class="hl std">(reshape2)</span>
</pre></div>
<div class="message"><pre class="knitr r">## 
## Attaching package: 'reshape2'
## 
## The following objects are masked from 'package:reshape':
## 
##     colsplit, melt, recast
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">load</span><span class="hl std">(</span><span class="hl str">&quot;3_Mats.RData&quot;</span><span class="hl std">)</span>

<span class="hl std">n</span> <span class="hl kwb">&lt;-</span> <span class="hl num">2000</span>

<span class="hl com"># HOW STRONG IS CORRELATION OF THIS mRNA VS ALL OTHERS?  -------------------</span>
<span class="hl com"># get all correlations (parallelized)</span>
<span class="hl kwd">library</span><span class="hl std">(doMC)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Loading required package: foreach
## Loading required package: iterators
## Loading required package: parallel
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">registerDoMC</span><span class="hl std">(</span><span class="hl kwc">cores</span> <span class="hl std">=</span> <span class="hl num">11</span><span class="hl std">)</span>
<span class="hl std">idces</span> <span class="hl kwb">&lt;-</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl kwd">length</span><span class="hl std">(proteins)</span>
<span class="hl std">corVecs</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">foreach</span><span class="hl std">(</span><span class="hl kwc">p.idx</span><span class="hl std">=idces)</span> <span class="hl opt">%dopar%</span> <span class="hl std">{</span>
  <span class="hl com"># correlate protein with all mRNAs</span>
  <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">sapply</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(p.idx,</span> <span class="hl kwd">sample</span><span class="hl std">(idces[</span><span class="hl opt">-</span><span class="hl std">p.idx], n)),</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">mRNA.idx</span><span class="hl std">)</span>
    <span class="hl kwd">cor</span><span class="hl std">(mats</span><span class="hl opt">$</span><span class="hl std">prots[p.idx,], mats</span><span class="hl opt">$</span><span class="hl std">mRNAs[mRNA.idx,],</span> <span class="hl kwc">method</span><span class="hl std">=</span><span class="hl str">&quot;spearman&quot;</span><span class="hl std">,</span> <span class="hl kwc">use</span><span class="hl std">=</span><span class="hl str">&quot;pairwise.complete.obs&quot;</span><span class="hl std">)</span>
  <span class="hl std">))</span>
<span class="hl std">}</span>
<span class="hl kwd">save</span><span class="hl std">(corVecs,</span> <span class="hl kwc">file</span><span class="hl std">=</span><span class="hl str">&quot;12_Cors.RData&quot;</span><span class="hl std">)</span>

<span class="hl com"># analyze</span>
<span class="hl kwd">load</span><span class="hl std">(</span><span class="hl str">&quot;12_Cors.RData&quot;</span><span class="hl std">)</span>
<span class="hl kwd">str</span><span class="hl std">(corVecs)</span>
</pre></div>
<div class="output"><pre class="knitr r">## List of 6104
##  $ : num [1:2001] 1 1 NA -1 -1 1 -1 -1 -1 NA ...
##  $ : num [1:2001] -0.0911 0.0699 0.6224 -0.0769 0.4126 ...
##  $ : num [1:2001] 0.2 0.6 -0.2 -0.3 1 -0.3 0.4 0.1 -0.2 -0.3 ...
##  $ : num [1:2001] 0.0876 -0.3538 0.8 -0.2867 -0.0105 ...
##  $ : num [1:2001] -0.321 0.679 0.607 0.464 0.5 ...
##  $ : num [1:2001] 0.538 -0.503 -0.161 -0.536 0.455 ...
##  $ : num [1:2001] -1 1 NA 1 -1 1 1 1 1 1 ...
##  $ : num [1:2001] 0.7143 0.1429 -0.7 -0.25 0.0901 ...
##  $ : num [1:2001] 0.251 -0.117 -0.628 0.167 -0.733 ...
##  $ : num [1:2001] 0.476 -0.021 0.434 -0.21 0.434 ...
##  $ : num [1:2001] 0.607 0 0.857 0.393 0.75 ...
##  $ : num [1:2001] 1 1 -1 1 1 1 -1 1 -1 -1 ...
##  $ : num [1:2001] 0 0.536 -0.286 -0.643 -0.36 ...
##  $ : num [1:2001] 0.231 -0.021 -0.368 -0.441 0.189 ...
##  $ : num [1:2001] -0.2485 0.1636 -0.3576 -0.4303 0.0545 ...
##  $ : num [1:2001] -1 -1 1 -1 NA -1 1 NA -1 -1 ...
##  $ : num [1:2001] -1 NA NA -0.5 -1 0.5 -0.5 -0.5 -0.5 1 ...
##  $ : num [1:2001] 0.203 -0.28 -0.287 -0.322 0.4 ...
##  $ : num [1:2001] -0.00699 -0.2662 0.02797 -0.16783 0.3986 ...
##  $ : num [1:2001] 0.5 0.6 -1 0.4 0.4 0.4 0 0.2 0.4 NA ...
##  $ : num [1:2001] 0.0455 0 -0.0909 -0.3077 -0.3591 ...
##  $ : num [1:2001] 0.1888 0.5 -0.0769 -0.6434 -0.613 ...
##  $ : num [1:2001] 0.1119 -0.1049 0.0559 -0.0721 -0.4615 ...
##  $ : num [1:2001] -0.5045 0.0357 0.0357 -0.25 -0.6667 ...
##  $ : num [1:2001] 0.5245 -0.2168 0.0699 0.4336 0.0769 ...
##  $ : num [1:2001] 0.2 -0.15 -0.0167 0.3849 -0.2333 ...
##  $ : num [1:2001] 0.5 1 NA -0.5 0.5 0.5 -0.5 -1 0.5 0.5 ...
##  $ : num [1:2001] 0.771 0.257 0.829 0.4 0.4 ...
##  $ : num [1:2001] NA -0.315 -0.426 1 -0.364 ...
##  $ : num [1:2001] -0.205 -0.5 -0.1 -0.2 -0.7 ...
##  $ : num [1:2001] 1 -1 NA 1 NA -1 -1 -1 1 -1 ...
##  $ : num [1:2001] 0.7203 -0.5245 -0.4476 -0.6993 0.0629 ...
##  $ : num [1:2001] 1 1 1 1 1 1 -1 1 1 1 ...
##  $ : num [1:2001] 0.3287 0.2727 NA -0.0636 -0.0352 ...
##  $ : num [1:2001] 0.5 -0.5 -1 0.5 NA -1 -0.5 -0.5 0.5 0.5 ...
##  $ : num [1:2001] 0.429 0.257 -0.486 -0.829 -0.886 ...
##  $ : num [1:2001] 0.3143 -0.8857 0.0857 0.1429 0.5429 ...
##  $ : num [1:2001] 1 -1 -1 1 -1 1 1 1 -1 1 ...
##  $ : num [1:2001] 0.3818 0.2606 -0.1758 -0.0547 -0.0909 ...
##  $ : num [1:2001] 0.5 -0.5 NA NA 0.5 1 -1 0.5 -1 -0.5 ...
##  $ : num [1:2001] 0.599 -0.0333 0.2587 0.2587 0.0559 ...
##  $ : num [1:2001] 1 -0.1 -0.333 -0.192 0.117 ...
##  $ : num [1:2001] NA -0.2 0.3 -0.175 -0.231 ...
##  $ : num [1:2001] 1 1 1 -1 1 -1 1 -1 1 1 ...
##  $ : num [1:2001] 0.5 -0.5 1 -1 -1 -0.5 1 NA -1 0.5 ...
##  $ : num [1:2001] 0.7 0.1 0.9 0.3 0.3 -0.7 0.5 0.3 0.3 0.3 ...
##  $ : num [1:2001] 0.0286 -0.7714 0.0286 0.4857 0 ...
##  $ : num [1:2001] 0.294 0.531 0.196 0.168 0.042 ...
##  $ : num [1:2001] -0.4126 -0.042 NA -0.0839 -0.1538 ...
##  $ : num [1:2001] -0.8 0.2143 0 0.0238 -0.0476 ...
##  $ : num [1:2001] 0.427 -0.228 -0.147 0.343 NA ...
##  $ : num [1:2001] 0.4667 -0.0909 -0.0182 -0.1277 0.0303 ...
##  $ : num [1:2001] 0.308 0.021 -0.252 0.224 0.5 ...
##  $ : num [1:2001] 0.5 NA 0.5 -0.5 NA -1 0.5 0.5 0.5 0.5 ...
##  $ : num [1:2001] NA NA NA NA NA NA NA NA NA NA ...
##  $ : num [1:2001] 0.214 0.357 0.143 0.156 -0.905 ...
##  $ : num [1:2001] NA NA NA NA NA NA NA NA NA NA ...
##  $ : num [1:2001] 0.5 -0.5 0.5 0.5 1 -0.5 0.5 0.5 -1 -0.5 ...
##  $ : num [1:2001] 0.112 -0.021 -0.266 0.028 0.112 ...
##  $ : num [1:2001] 0.1 0.8 0.2 0.2 -0.4 0.1 -0.1 0.6 -0.7 0.9 ...
##  $ : num [1:2001] -0.0818 0.2545 0.0636 0.4 0.0182 ...
##  $ : num [1:2001] 0.25 -0.0714 1 -0.6 0.2857 ...
##  $ : num [1:2001] 0.4 0.5 0.536 -0.107 -0.286 ...
##  $ : num [1:2001] NA NA NA NA NA NA NA NA NA NA ...
##  $ : num [1:2001] -1 1 0.5 0 -0.5 1 NA 0.5 0.5 -0.5 ...
##  $ : num [1:2001] -0.0476 0.3095 -0.2052 0.3571 0.1952 ...
##  $ : num [1:2001] -0.154 -0.14 -0.105 0.126 0.424 ...
##  $ : num [1:2001] -1 NA -1 NA -1 1 1 -1 -1 1 ...
##  $ : num [1:2001] -1 -1 1 -1 -1 1 NA 1 1 1 ...
##  $ : num [1:2001] -0.2667 0.1333 0.5774 0.1 -0.0167 ...
##  $ : num [1:2001] -0.4 -0.6 0 -0.3 -0.3 -0.4 -0.7 -0.4 -0.7 -0.9 ...
##  $ : num [1:2001] NA NA NA NA NA NA NA NA NA NA ...
##  $ : num [1:2001] -0.8 -1 -0.8 0.4 -0.4 1 -0.2 NA 0 0.6 ...
##  $ : num [1:2001] -0.3706 -0.1888 -0.0273 0.2417 -0.2238 ...
##  $ : num [1:2001] 1 -1 NA -1 -1 1 1 -1 1 -1 ...
##  $ : num [1:2001] 0.336 -0.273 0.028 0.413 0.063 ...
##  $ : num [1:2001] -0.7 -0.6 0.6 -0.1 -0.7 ...
##  $ : num [1:2001] 0.0545 0.2364 -0.0545 0.0788 -0.1818 ...
##  $ : num [1:2001] 0.0385 -0.4545 0.4476 -0.1469 0.3566 ...
##  $ : num [1:2001] 0.6571 -0.4857 -0.2 0.3714 -0.0857 ...
##  $ : num [1:2001] NA -0.1429 -0.5429 -0.4286 0.0286 ...
##  $ : num [1:2001] -1 -0.5 -1 1 NA 0.5 -0.5 -0.5 -1 0.5 ...
##  $ : num [1:2001] NA NA NA NA NA NA NA NA NA NA ...
##  $ : num [1:2001] 0.381 -0.2143 -0.0476 0.1429 0.4671 ...
##  $ : num [1:2001] 0.6 -0.5 0.6 0 -0.8 -0.4 0 -1 0.3 0.7 ...
##  $ : num [1:2001] 0.718 -0.5 -0.6 0.6 0.1 ...
##  $ : num [1:2001] 0 0 NA NA -0.7 ...
##  $ : num [1:2001] -0.0636 0.5182 -0.5786 0.5545 -0.615 ...
##  $ : num [1:2001] 0.2238 -0.028 -0.2308 -0.0909 -0.2727 ...
##  $ : num [1:2001] 0.7727 0.2727 0.2455 -0.0364 -0.1545 ...
##  $ : num [1:2001] NA 1 -1 -1 -1 -1 -1 1 -1 -1 ...
##  $ : num [1:2001] -0.426 NA 0.539 -0.152 -0.321 ...
##  $ : num [1:2001] -1 -1 -1 -1 NA -1 1 -1 1 -1 ...
##  $ : num [1:2001] -0.1968 0.1909 -0.2364 -0.0866 -0.0729 ...
##  $ : num [1:2001] 0.0714 NA 0.3714 -0.3929 0.5714 ...
##  $ : num [1:2001] 0.2727 0.1636 0.0839 0.6364 -0.1469 ...
##  $ : num [1:2001] 0.462 -0.035 0.21 0.196 0.364 ...
##  $ : num [1:2001] 1 1 1 1 -1 1 -1 1 -1 1 ...
##  $ : num [1:2001] 0.45 -0.05 0.1333 -0.15 0.0667 ...
##   [list output truncated]
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">corVecs2</span> <span class="hl kwb">&lt;-</span> <span class="hl std">corVecs[</span><span class="hl kwd">which</span><span class="hl std">(</span><span class="hl kwd">sapply</span><span class="hl std">(corVecs,</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">v</span><span class="hl std">)</span> <span class="hl kwd">sum</span><span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(</span><span class="hl kwd">round</span><span class="hl std">(v,</span><span class="hl num">2</span><span class="hl std">))</span> <span class="hl opt">!=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">na.rm</span><span class="hl std">=T))</span> <span class="hl opt">&gt;</span> <span class="hl num">0</span><span class="hl std">)]</span>

<span class="hl std">pDat</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(</span><span class="hl kwc">Fraction</span><span class="hl std">=</span><span class="hl kwd">sapply</span><span class="hl std">(corVecs2,</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">v</span><span class="hl std">)</span> <span class="hl kwd">sum</span><span class="hl std">(v[</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">]</span><span class="hl opt">&gt;</span><span class="hl std">v[</span><span class="hl num">1</span><span class="hl std">],</span> <span class="hl kwc">na.rm</span><span class="hl std">=T)</span><span class="hl opt">/</span><span class="hl kwd">length</span><span class="hl std">(v[</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">])))</span>

<span class="hl kwd">ggplot</span><span class="hl std">(pDat,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=Fraction))</span> <span class="hl opt">+</span> <span class="hl kwd">stat_ecdf</span><span class="hl std">()</span> <span class="hl opt">+</span>
  <span class="hl kwd">theme_bw</span><span class="hl std">(</span><span class="hl num">24</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">xlab</span><span class="hl std">(</span><span class="hl kwd">paste0</span><span class="hl std">(</span><span class="hl str">&quot;Fraction of random mRNAs (n=&quot;</span><span class="hl std">, n,</span> <span class="hl str">&quot; draws) \n with higher correlation&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span>
  <span class="hl kwd">xlim</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">)</span> <span class="hl opt">+</span> <span class="hl kwd">ylab</span><span class="hl std">(</span><span class="hl str">&quot;ECDF&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">ggtitle</span><span class="hl std">(</span><span class="hl kwd">paste0</span><span class="hl std">(</span><span class="hl kwd">sum</span><span class="hl std">(pDat</span><span class="hl opt">$</span><span class="hl std">Fraction</span> <span class="hl opt">&lt;</span> <span class="hl num">0.05</span><span class="hl std">),</span> <span class="hl str">&quot; of &quot;</span><span class="hl std">,</span> <span class="hl kwd">length</span><span class="hl std">(corVecs2),</span> <span class="hl str">&quot; are &lt; 0.05&quot;</span><span class="hl std">))</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: Removed 2 rows containing missing values (geom_path).
</pre></div>
</div><div class="rimage center"><img src="figure/12-Random-Pval-PerGene-Rhtmlauto-report-1.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">ggsave</span><span class="hl std">(</span><span class="hl str">&quot;12_Pvals_ECDF.pdf&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Saving 6 x 6 in image
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: Removed 2 rows containing missing values (geom_path).
</pre></div>
</div></div>

  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r">    <span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 3.1.2 (2014-10-31)
## Platform: x86_64-unknown-linux-gnu (64-bit)
## 
## locale:
##  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8       
##  [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8   
##  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
## [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  base     
## 
## other attached packages:
## [1] doMC_1.3.3      iterators_1.0.8 foreach_1.4.3   reshape2_1.4.1  reshape_0.8.5  
## [6] ggplot2_2.0.0   gdata_2.17.0   
## 
## loaded via a namespace (and not attached):
##  [1] codetools_0.2-14 colorspace_1.2-6 compiler_3.1.2   evaluate_0.7     formatR_1.2     
##  [6] grid_3.1.2       gtable_0.1.2     gtools_3.5.0     highr_0.5        knitr_1.10.5    
## [11] labeling_0.3     magrittr_1.5     methods_3.1.2    munsell_0.4.2    plyr_1.8.3      
## [16] Rcpp_0.12.0      scales_0.3.0     stringi_1.0-1    stringr_1.0.0    tools_3.1.2
</pre></div>
<div class="source"><pre class="knitr r">    <span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;2016-02-04 17:33:52 PST&quot;
</pre></div>
</div></div>


</body>
</html>
