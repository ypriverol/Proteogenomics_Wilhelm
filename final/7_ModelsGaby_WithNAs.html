
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="http://yihui.name/media/js/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="http://yihui.name/knitr"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.10.5</code>)
    .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">source</span><span class="hl std">(</span><span class="hl str">&quot;../0_SETUP.R&quot;</span><span class="hl std">)</span>
<span class="hl kwd">setwd</span><span class="hl std">(</span><span class="hl str">&quot;final/&quot;</span><span class="hl std">)</span>

<span class="hl kwd">library</span><span class="hl std">(gdata)</span>
</pre></div>
<div class="message"><pre class="knitr r">## gdata: read.xls support for 'XLS' (Excel 97-2004) files ENABLED.
## 
## gdata: Unable to load perl libaries needed by read.xls()
## gdata: to support 'XLSX' (Excel 2007+) files.
## 
## gdata: Run the function 'installXLSXsupport()'
## gdata: to automatically download and install the perl
## gdata: libaries needed to support Excel XLS and XLSX formats.
## 
## Attaching package: 'gdata'
## 
## The following object is masked from 'package:stats':
## 
##     nobs
## 
## The following object is masked from 'package:utils':
## 
##     object.size
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(ggplot2)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Loading required package: methods
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(reshape)</span>
<span class="hl kwd">library</span><span class="hl std">(reshape2)</span>
</pre></div>
<div class="message"><pre class="knitr r">## 
## Attaching package: 'reshape2'
## 
## The following objects are masked from 'package:reshape':
## 
##     colsplit, melt, recast
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">load</span><span class="hl std">(</span><span class="hl str">&quot;1_Mats.RData&quot;</span><span class="hl std">)</span>
<span class="hl com"># load(&quot;7_Models.RData&quot;)</span>

<span class="hl kwd">str</span><span class="hl std">(mDat</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">melt</span><span class="hl std">(mats</span><span class="hl opt">$</span><span class="hl std">mRNAs))</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	73248 obs. of  3 variables:
##  $ X1   : Factor w/ 6104 levels &quot;ENSG00000000003&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ X2   : Factor w/ 12 levels &quot;adrenal.gland&quot;,..: 12 12 12 12 12 12 12 12 12 12 ...
##  $ value: num  2.50e-05 3.44e-05 7.80e-06 1.42e-05 3.46e-05 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">str</span><span class="hl std">(pDat</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">melt</span><span class="hl std">(mats</span><span class="hl opt">$</span><span class="hl std">prots))</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	73248 obs. of  3 variables:
##  $ X1   : Factor w/ 6104 levels &quot;ENSG00000000003&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ X2   : Factor w/ 12 levels &quot;adrenal.gland&quot;,..: 12 12 12 12 12 12 12 12 12 12 ...
##  $ value: num  NA 9.97e-06 NA 3.63e-05 1.68e-05 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">str</span><span class="hl std">(modelDat</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">merge</span><span class="hl std">(mDat, pDat,</span> <span class="hl kwc">by</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;X1&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;X2&quot;</span><span class="hl std">)))</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	73248 obs. of  4 variables:
##  $ X1     : Factor w/ 6104 levels &quot;ENSG00000000003&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ X2     : Factor w/ 12 levels &quot;adrenal.gland&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ value.x: num  2.16e-05 4.76e-05 4.44e-05 5.60e-05 1.43e-05 ...
##  $ value.y: num  NA NA NA NA NA ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">colnames</span><span class="hl std">(modelDat)</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Gene&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Tissue&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;mRNA&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Protein&quot;</span><span class="hl std">)</span>
<span class="hl std">genes</span> <span class="hl kwb">&lt;-</span> <span class="hl std">proteins</span>

<span class="hl com"># Get NAs</span>
<span class="hl kwd">table</span><span class="hl std">(na.count</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sapply</span><span class="hl std">(genes,</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">p</span><span class="hl std">){</span>
  <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">sum</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(mats</span><span class="hl opt">$</span><span class="hl std">prots[p,])</span> <span class="hl opt">|</span> <span class="hl kwd">is.na</span><span class="hl std">(mats</span><span class="hl opt">$</span><span class="hl std">mRNA[p,])))</span>
<span class="hl std">}))</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
##    0    1    2    3    4    5    6    7    8    9   10   11   12 
## 1392  493  363  315  280  321  322  371  432  535  747  350  183
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># which genes to look at?</span>
<span class="hl kwd">str</span><span class="hl std">(genes</span> <span class="hl kwb">&lt;-</span> <span class="hl std">genes[</span><span class="hl kwd">which</span><span class="hl std">(na.count</span> <span class="hl opt">&lt;=</span> <span class="hl num">9</span><span class="hl std">)])</span>
</pre></div>
<div class="output"><pre class="knitr r">##  chr [1:4824] &quot;ENSG00000000419&quot; &quot;ENSG00000000457&quot; &quot;ENSG00000000971&quot; ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># str(genes &lt;- genes[1:150]) # for a first test, just a subset of genes</span>
<span class="hl std">modelDat</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">drop.levels</span><span class="hl std">(</span><span class="hl kwd">subset</span><span class="hl std">(modelDat, Gene</span> <span class="hl opt">%in%</span> <span class="hl std">genes))</span>

<span class="hl com"># SLOPE ONLY --------------------------------------------------------------</span>
<span class="hl std">lmRatio</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lm</span><span class="hl std">(Protein</span> <span class="hl opt">~</span> <span class="hl std">Gene</span><span class="hl opt">:</span><span class="hl std">mRNA</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">data</span><span class="hl std">=modelDat)</span>
<span class="hl kwd">summary</span><span class="hl std">(lmRatio)</span><span class="hl opt">$</span><span class="hl std">r.squared</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.433832
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">head</span><span class="hl std">(lmRatio</span><span class="hl opt">$</span><span class="hl std">coefficients)</span>
</pre></div>
<div class="output"><pre class="knitr r">## GeneENSG00000000419:mRNA GeneENSG00000000457:mRNA GeneENSG00000000971:mRNA 
##                0.5337510                0.4062180                6.0782793 
## GeneENSG00000001036:mRNA GeneENSG00000001084:mRNA GeneENSG00000001630:mRNA 
##                0.3120417                2.3327891                1.6115992
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">length</span><span class="hl std">(lmRatio</span><span class="hl opt">$</span><span class="hl std">coefficients)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 4824
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># INTERCEPT only ---------------------------------------------------------------</span>
<span class="hl std">lmIntercept</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lm</span><span class="hl std">(Protein</span> <span class="hl opt">~</span> <span class="hl std">Gene</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">data</span><span class="hl std">=modelDat)</span>
<span class="hl kwd">summary</span><span class="hl std">(lmIntercept)</span><span class="hl opt">$</span><span class="hl std">r.squared</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.6422954
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">head</span><span class="hl std">(lmIntercept</span><span class="hl opt">$</span><span class="hl std">coefficients)</span>
</pre></div>
<div class="output"><pre class="knitr r">## GeneENSG00000000419 GeneENSG00000000457 GeneENSG00000000971 GeneENSG00000001036 
##        2.016668e-05        2.618303e-06        1.970348e-04        1.515984e-05 
## GeneENSG00000001084 GeneENSG00000001630 
##        4.441240e-05        3.677706e-05
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">length</span><span class="hl std">(lmIntercept</span><span class="hl opt">$</span><span class="hl std">coefficients)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 4824
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># FULL MODEL --------------------------------------------------------------</span>
<span class="hl std">lmFull</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lm</span><span class="hl std">(Protein</span> <span class="hl opt">~</span> <span class="hl std">Gene</span><span class="hl opt">*</span><span class="hl std">mRNA,</span> <span class="hl kwc">data</span><span class="hl std">=modelDat)</span>
<span class="hl kwd">summary</span><span class="hl std">(lmFull)</span><span class="hl opt">$</span><span class="hl std">r.squared</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.6744895
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">head</span><span class="hl std">(lmFull</span><span class="hl opt">$</span><span class="hl std">coefficients)</span>
</pre></div>
<div class="output"><pre class="knitr r">##         (Intercept) GeneENSG00000000457 GeneENSG00000000971 GeneENSG00000001036 
##        3.281122e-05       -3.338816e-05        7.073165e-05       -8.401759e-07 
## GeneENSG00000001084 GeneENSG00000001630 
##       -4.726980e-05       -6.730204e-05
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">length</span><span class="hl std">(lmFull</span><span class="hl opt">$</span><span class="hl std">coefficients)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 9648
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># ANOVA -------------------------------------------------------------------</span>
<span class="hl com"># this is what they should have done:</span>
<span class="hl kwd">anova</span><span class="hl std">(lmRatio, lmIntercept)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in anova.lmlist(object, ...): models were not all fitted to the same size of dataset
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># this is our way:</span>
<span class="hl kwd">anova</span><span class="hl std">(lmFull, lmIntercept)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in anova.lmlist(object, ...): models were not all fitted to the same size of dataset
</pre></div>
</div></div>

  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r">    <span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 3.1.2 (2014-10-31)
## Platform: x86_64-unknown-linux-gnu (64-bit)
## 
## locale:
##  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8       
##  [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8   
##  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
## [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] methods   stats     graphics  grDevices utils     datasets  base     
## 
## other attached packages:
## [1] reshape2_1.4.1 reshape_0.8.5  ggplot2_1.0.1  gdata_2.17.0  
## 
## loaded via a namespace (and not attached):
##  [1] colorspace_1.2-6 digest_0.6.8     evaluate_0.7     formatR_1.2      grid_3.1.2      
##  [6] gtable_0.1.2     gtools_3.5.0     highr_0.5        knitr_1.10.5     magrittr_1.5    
## [11] MASS_7.3-41      munsell_0.4.2    plyr_1.8.3       proto_0.3-10     Rcpp_0.12.0     
## [16] scales_0.3.0     stringi_1.0-1    stringr_1.0.0    tools_3.1.2
</pre></div>
<div class="source"><pre class="knitr r">    <span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;2015-12-21 18:02:49 PST&quot;
</pre></div>
</div></div>


</body>
</html>
