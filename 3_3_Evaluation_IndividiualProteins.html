
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="http://yihui.name/media/js/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="http://yihui.name/knitr"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.10.5</code>)
    .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">setwd</span><span class="hl std">(</span><span class="hl str">&quot;~/OtherAnalysis/2015_07_03_mRNAvsProtein/DraftMapOfHumanProteome/&quot;</span><span class="hl std">)</span>

<span class="hl std">(</span><span class="hl kwd">load</span><span class="hl std">(</span><span class="hl str">&quot;2_mats.RData&quot;</span><span class="hl std">))</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;mats&quot;     &quot;tissues&quot;  &quot;proteins&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">(</span><span class="hl kwd">names</span><span class="hl std">(mats)</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">gsub</span><span class="hl std">(</span><span class="hl str">&quot;LOO&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;zLOO&quot;</span><span class="hl std">,</span> <span class="hl kwd">gsub</span><span class="hl std">(</span><span class="hl str">&quot;NI&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;zNI&quot;</span><span class="hl std">,</span> <span class="hl kwd">gsub</span><span class="hl std">(</span><span class="hl str">&quot;TFs&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;zTFs&quot;</span><span class="hl std">,</span> <span class="hl kwd">names</span><span class="hl std">(mats)))))</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] &quot;mRNAs&quot;            &quot;prots&quot;            &quot;ratio&quot;            &quot;ratio_zLOO&quot;      
##  [5] &quot;lm_zNI&quot;           &quot;lm&quot;               &quot;lm_zTFs&quot;          &quot;elastic_zTFs&quot;    
##  [9] &quot;elastic_zTFs_zNI&quot; &quot;interceptOnly&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">lapply</span><span class="hl std">(mats, str)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  num [1:1392, 1:12] 3.44e-05 1.42e-05 1.92e-05 3.64e-05 3.89e-05 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:1392] &quot;ENSG00000000419&quot; &quot;ENSG00000000971&quot; &quot;ENSG00000001084&quot; &quot;ENSG00000002549&quot; ...
##   ..$ : chr [1:12] &quot;uterus&quot; &quot;kidney&quot; &quot;testis&quot; &quot;pancreas&quot; ...
##  num [1:1392, 1:12] 9.97e-06 3.63e-05 1.69e-05 6.75e-05 5.55e-05 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:1392] &quot;ENSG00000000419&quot; &quot;ENSG00000000971&quot; &quot;ENSG00000001084&quot; &quot;ENSG00000002549&quot; ...
##   ..$ : chr [1:12] &quot;uterus&quot; &quot;kidney&quot; &quot;testis&quot; &quot;pancreas&quot; ...
##  num [1:1392, 1:12] 1.60e-05 1.11e-04 3.53e-05 2.26e-04 3.02e-04 ...
##  num [1:1392, 1:12] 1.90e-05 1.13e-04 3.95e-05 2.43e-04 3.06e-04 ...
##  num [1:1392, 1:12] 1.91e-05 8.71e-05 4.67e-05 3.10e-04 3.06e-04 ...
##  num [1:1392, 1:12] 2.12e-05 1.70e-04 4.40e-05 2.49e-04 3.20e-04 ...
##  num [1:1392, 1:12] 3.64e-05 4.80e-05 2.62e-05 2.97e-04 4.46e-04 ...
##  num [1:1392, 1:12] 3.26e-05 1.31e-04 2.92e-05 2.38e-04 4.35e-04 ...
##  num [1:1392, 1:12] 7.45e-06 7.01e-05 2.90e-05 2.57e-04 1.00e-04 ...
##  num [1:1392, 1:12] 2.11e-05 2.12e-04 4.69e-05 3.77e-04 3.02e-04 ...
</pre></div>
<div class="output"><pre class="knitr r">## $mRNAs
## NULL
## 
## $prots
## NULL
## 
## $ratio
## NULL
## 
## $ratio_zLOO
## NULL
## 
## $lm_zNI
## NULL
## 
## $lm
## NULL
## 
## $lm_zTFs
## NULL
## 
## $elastic_zTFs
## NULL
## 
## $elastic_zTFs_zNI
## NULL
## 
## $interceptOnly
## NULL
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">sapply</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(mats), sum)</span>
</pre></div>
<div class="output"><pre class="knitr r">##            mRNAs            prots            ratio       ratio_zLOO           lm_zNI 
##                0                0                0                0                0 
##               lm          lm_zTFs     elastic_zTFs elastic_zTFs_zNI    interceptOnly 
##                0                0                0                0                0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">sapply</span><span class="hl std">(mats,</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">m</span><span class="hl std">)</span> <span class="hl kwd">sum</span><span class="hl std">(m</span><span class="hl opt">==</span><span class="hl num">0</span><span class="hl std">))</span>
</pre></div>
<div class="output"><pre class="knitr r">##            mRNAs            prots            ratio       ratio_zLOO           lm_zNI 
##                0                0                0                0                0 
##               lm          lm_zTFs     elastic_zTFs elastic_zTFs_zNI    interceptOnly 
##                0                0                0                0                0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(reshape)</span>
<span class="hl kwd">library</span><span class="hl std">(ggplot2)</span>

<span class="hl std">mses</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lapply</span><span class="hl std">(mats,</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">m</span><span class="hl std">)</span> <span class="hl kwd">return</span><span class="hl std">((m</span><span class="hl opt">-</span><span class="hl std">mats</span><span class="hl opt">$</span><span class="hl std">prot)</span><span class="hl opt">**</span><span class="hl num">2</span><span class="hl std">))</span>

<span class="hl com"># FUNCTION TO PLOT ONE PROTEIN</span>
<span class="hl std">plotProtein</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">p</span><span class="hl std">,</span> <span class="hl kwc">pred</span><span class="hl std">){</span>
  <span class="hl kwa">if</span><span class="hl std">(</span><span class="hl kwd">is.character</span><span class="hl std">(p)){p</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">which</span><span class="hl std">(proteins</span> <span class="hl opt">==</span> <span class="hl std">p)}</span>
  <span class="hl std">pDat</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(</span>
    <span class="hl kwc">tissue</span> <span class="hl std">= tissues,</span>
    <span class="hl kwc">mRNA</span><span class="hl std">=mats</span><span class="hl opt">$</span><span class="hl std">mRNAs[p,tissues],</span>
    <span class="hl kwc">protein</span><span class="hl std">=mats</span><span class="hl opt">$</span><span class="hl std">prots[p,tissues])</span>
  <span class="hl kwa">for</span><span class="hl std">(x</span> <span class="hl kwa">in</span> <span class="hl std">pred){</span>
    <span class="hl std">pDat[,x]</span> <span class="hl kwb">&lt;-</span> <span class="hl std">mats[[x]][p,]</span>
  <span class="hl std">}</span>
  <span class="hl std">plot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl std">(</span><span class="hl kwd">melt</span><span class="hl std">(pDat),</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=tissue,</span> <span class="hl kwc">y</span><span class="hl std">=value,</span> <span class="hl kwc">colour</span><span class="hl std">=variable,</span> <span class="hl kwc">group</span><span class="hl std">=variable))</span> <span class="hl opt">+</span> <span class="hl kwd">geom_line</span><span class="hl std">()</span> <span class="hl opt">+</span> <span class="hl kwd">theme_bw</span><span class="hl std">(</span><span class="hl num">24</span><span class="hl std">)</span> <span class="hl opt">+</span> <span class="hl kwd">theme</span><span class="hl std">(</span><span class="hl kwc">axis.text.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">angle</span> <span class="hl std">=</span> <span class="hl num">90</span><span class="hl std">,</span> <span class="hl kwc">hjust</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">))</span>
  <span class="hl kwd">return</span><span class="hl std">(plot)</span>
<span class="hl std">}</span>


<span class="hl com"># COMPARISON BETWEEN METHODS ----------------------------------------------</span>

<span class="hl kwd">str</span><span class="hl std">(mses2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">do.call</span><span class="hl std">(rbind,</span> <span class="hl kwd">lapply</span><span class="hl std">(mses,</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">mat</span><span class="hl std">)</span> <span class="hl kwd">apply</span><span class="hl std">(mat,</span> <span class="hl num">1</span><span class="hl std">, mean))))</span>
</pre></div>
<div class="output"><pre class="knitr r">##  num [1:10, 1:1392] 5.29e-10 0.00 2.61e-10 3.52e-10 3.04e-10 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:10] &quot;mRNAs&quot; &quot;prots&quot; &quot;ratio&quot; &quot;ratio_zLOO&quot; ...
##   ..$ : chr [1:1392] &quot;ENSG00000000419&quot; &quot;ENSG00000000971&quot; &quot;ENSG00000001084&quot; &quot;ENSG00000002549&quot; ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">str</span><span class="hl std">(mses2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(</span><span class="hl kwd">t</span><span class="hl std">(mses2)))</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	1392 obs. of  10 variables:
##  $ mRNAs           : num  5.29e-10 4.43e-08 1.86e-09 2.16e-07 8.53e-08 ...
##  $ prots           : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ ratio           : num  2.61e-10 2.02e-08 1.11e-09 9.43e-08 2.29e-08 ...
##  $ ratio_zLOO      : num  3.52e-10 2.12e-08 1.42e-09 1.05e-07 2.38e-08 ...
##  $ lm_zNI          : num  3.04e-10 2.13e-08 1.29e-09 1.20e-07 2.66e-08 ...
##  $ lm              : num  3.06e-10 3.26e-08 1.35e-09 1.49e-07 2.60e-08 ...
##  $ lm_zTFs         : num  9.77e-10 5.67e-08 1.62e-09 2.09e-07 3.91e-08 ...
##  $ elastic_zTFs    : num  4.11e-10 4.71e-08 1.51e-09 1.99e-07 3.50e-08 ...
##  $ elastic_zTFs_zNI: num  3.78e-10 3.78e-08 1.98e-09 1.83e-07 6.86e-08 ...
##  $ interceptOnly   : num  2.48e-10 2.06e-08 1.99e-09 1.57e-07 3.27e-08 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">cor</span><span class="hl std">(mses2,</span> <span class="hl kwc">method</span><span class="hl std">=</span><span class="hl str">&quot;spearman&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in cor(mses2, method = &quot;spearman&quot;): the standard deviation is zero
</pre></div>
<div class="output"><pre class="knitr r">##                      mRNAs prots     ratio ratio_zLOO    lm_zNI        lm   lm_zTFs
## mRNAs            1.0000000    NA 0.9415639  0.9397883 0.9409172 0.9374578 0.9218910
## prots                   NA     1        NA         NA        NA        NA        NA
## ratio            0.9415639    NA 1.0000000  0.9983576 0.9966591 0.9869557 0.9729319
## ratio_zLOO       0.9397883    NA 0.9983576  1.0000000 0.9950770 0.9853467 0.9718978
## lm_zNI           0.9409172    NA 0.9966591  0.9950770 1.0000000 0.9924133 0.9778762
## lm               0.9374578    NA 0.9869557  0.9853467 0.9924133 1.0000000 0.9810474
## lm_zTFs          0.9218910    NA 0.9729319  0.9718978 0.9778762 0.9810474 1.0000000
## elastic_zTFs     0.9298675    NA 0.9801159  0.9794400 0.9844545 0.9895619 0.9922312
## elastic_zTFs_zNI 0.9412920    NA 0.9813487  0.9808734 0.9846109 0.9854583 0.9718362
## interceptOnly    0.9407066    NA 0.9817880  0.9806193 0.9835140 0.9872684 0.9684673
##                  elastic_zTFs elastic_zTFs_zNI interceptOnly
## mRNAs               0.9298675        0.9412920     0.9407066
## prots                      NA               NA            NA
## ratio               0.9801159        0.9813487     0.9817880
## ratio_zLOO          0.9794400        0.9808734     0.9806193
## lm_zNI              0.9844545        0.9846109     0.9835140
## lm                  0.9895619        0.9854583     0.9872684
## lm_zTFs             0.9922312        0.9718362     0.9684673
## elastic_zTFs        1.0000000        0.9814005     0.9811444
## elastic_zTFs_zNI    0.9814005        1.0000000     0.9904942
## interceptOnly       0.9811444        0.9904942     1.0000000
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Linear model without intercept is pretty much like ratio!!</span>
<span class="hl kwd">str</span><span class="hl std">(dif</span> <span class="hl kwb">&lt;-</span> <span class="hl std">mses2</span><span class="hl opt">$</span><span class="hl std">lm_zNI</span> <span class="hl opt">-</span> <span class="hl std">mses2</span><span class="hl opt">$</span><span class="hl std">ratio_zLOO)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  num [1:1392] -4.81e-11 3.41e-11 -1.34e-10 1.53e-08 2.82e-09 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(dif</span> <span class="hl opt">==</span> <span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(dif),</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">))[</span><span class="hl num">1</span><span class="hl std">],</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm_zNI&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio_zLOO&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-1.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(dif</span> <span class="hl opt">==</span> <span class="hl kwd">head</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(dif),</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">))[</span><span class="hl num">1</span><span class="hl std">],</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm_zNI&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio_zLOO&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-2.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Linear model is different from ratio but mostly because of the intercept!!</span>
<span class="hl kwd">str</span><span class="hl std">(dif</span> <span class="hl kwb">&lt;-</span> <span class="hl std">mses2</span><span class="hl opt">$</span><span class="hl std">lm</span> <span class="hl opt">-</span> <span class="hl std">mses2</span><span class="hl opt">$</span><span class="hl std">ratio_zLOO)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  num [1:1392] -4.63e-11 1.14e-08 -6.80e-11 4.46e-08 2.13e-09 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(dif</span> <span class="hl opt">==</span> <span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(dif),</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">))[</span><span class="hl num">1</span><span class="hl std">],</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio_zLOO&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-3.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(dif</span> <span class="hl opt">==</span> <span class="hl kwd">head</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(dif),</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">))[</span><span class="hl num">1</span><span class="hl std">],</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio_zLOO&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-4.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># same is true for the elastic net</span>
<span class="hl kwd">str</span><span class="hl std">(dif</span> <span class="hl kwb">&lt;-</span> <span class="hl std">mses2</span><span class="hl opt">$</span><span class="hl std">elastic_zTFs_zNI</span> <span class="hl opt">-</span> <span class="hl std">mses2</span><span class="hl opt">$</span><span class="hl std">ratio_zLOO)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  num [1:1392] 2.55e-11 1.66e-08 5.62e-10 7.89e-08 4.47e-08 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(dif</span> <span class="hl opt">==</span> <span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(dif),</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">))[</span><span class="hl num">1</span><span class="hl std">],</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;elastic_zTFs_zNI&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio_zLOO&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-5.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(dif</span> <span class="hl opt">==</span> <span class="hl kwd">head</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(dif),</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">))[</span><span class="hl num">1</span><span class="hl std">],</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;elastic_zTFs_zNI&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio_zLOO&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-6.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># SOME EXAMPLES? --------------------------------------------------------</span>

<span class="hl com"># HIGH MSE in RATIO</span>
<span class="hl std">maxMSE</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">apply</span><span class="hl std">(mses</span><span class="hl opt">$</span><span class="hl std">ratio,</span> <span class="hl num">1</span><span class="hl std">, max)</span>
<span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(maxMSE))</span>
</pre></div>
<div class="output"><pre class="knitr r">## ENSG00000143546 ENSG00000135046 ENSG00000197249 ENSG00000244734 ENSG00000163220 
##     0.004311824     0.005039600     0.013633157     0.055682008     0.067461517 
## ENSG00000188536 
##     0.136403699
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(maxMSE),</span> <span class="hl kwc">n</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">)),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-7.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">sort</span><span class="hl std">(maxMSE)[</span><span class="hl kwd">length</span><span class="hl std">(maxMSE)</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">]),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-8.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">sort</span><span class="hl std">(maxMSE)[</span><span class="hl kwd">length</span><span class="hl std">(maxMSE)</span><span class="hl opt">-</span><span class="hl num">2</span><span class="hl std">]),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-9.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># HIGH MSE in LM</span>
<span class="hl std">maxMSE</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">apply</span><span class="hl std">(mses</span><span class="hl opt">$</span><span class="hl std">lm,</span> <span class="hl num">1</span><span class="hl std">, max)</span>
<span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(maxMSE))</span>
</pre></div>
<div class="output"><pre class="knitr r">## ENSG00000160213 ENSG00000143546 ENSG00000135046 ENSG00000149591 ENSG00000244734 
##    0.0006345375    0.0008597467    0.0009895582    0.0022166033    0.0291593481 
## ENSG00000188536 
##    0.0445602500
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(maxMSE),</span> <span class="hl kwc">n</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">)),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-10.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">sort</span><span class="hl std">(maxMSE)[</span><span class="hl kwd">length</span><span class="hl std">(maxMSE)</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">]),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-11.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">sort</span><span class="hl std">(maxMSE)[</span><span class="hl kwd">length</span><span class="hl std">(maxMSE)</span><span class="hl opt">-</span><span class="hl num">2</span><span class="hl std">]),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-12.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># HIGH MSE in LM without zNI</span>
<span class="hl std">maxMSE</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">apply</span><span class="hl std">(mses</span><span class="hl opt">$</span><span class="hl std">lm_zNI,</span> <span class="hl num">1</span><span class="hl std">, max)</span>
<span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(maxMSE))</span>
</pre></div>
<div class="output"><pre class="knitr r">## ENSG00000160213 ENSG00000163220 ENSG00000149591 ENSG00000135046 ENSG00000244734 
##     0.001684453     0.001849463     0.002719526     0.004279751     0.044264529 
## ENSG00000188536 
##     0.084235204
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(maxMSE),</span> <span class="hl kwc">n</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">)),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;lm_zNI&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-13.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">sort</span><span class="hl std">(maxMSE)[</span><span class="hl kwd">length</span><span class="hl std">(maxMSE)</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">]),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;lm_zNI&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-14.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">sort</span><span class="hl std">(maxMSE)[</span><span class="hl kwd">length</span><span class="hl std">(maxMSE)</span><span class="hl opt">-</span><span class="hl num">2</span><span class="hl std">]),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;lm_zNI&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in scale$trans$trans(x): NaNs produced
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-15.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># HIGH MSE in elastic without zNI</span>
<span class="hl std">maxMSE</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">apply</span><span class="hl std">(mses</span><span class="hl opt">$</span><span class="hl std">elastic_zTFs_zNI,</span> <span class="hl num">1</span><span class="hl std">, max)</span>
<span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(maxMSE))</span>
</pre></div>
<div class="output"><pre class="knitr r">## ENSG00000143546 ENSG00000085662 ENSG00000111640 ENSG00000149591 ENSG00000244734 
##    0.0006162443    0.0006797408    0.0008667925    0.0008951082    0.0365444482 
## ENSG00000188536 
##    0.0641935715
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">tail</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(maxMSE),</span> <span class="hl kwc">n</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">)),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;elastic_zTFs_zNI&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-16.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">sort</span><span class="hl std">(maxMSE)[</span><span class="hl kwd">length</span><span class="hl std">(maxMSE)</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">]),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;elastic_zTFs_zNI&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-17.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl kwd">plotProtein</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(maxMSE</span> <span class="hl opt">%in%</span> <span class="hl kwd">sort</span><span class="hl std">(maxMSE)[</span><span class="hl kwd">length</span><span class="hl std">(maxMSE)</span><span class="hl opt">-</span><span class="hl num">2</span><span class="hl std">]),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;lm&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;ratio&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;elastic_zTFs_zNI&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span> <span class="hl kwd">scale_y_log10</span><span class="hl std">()</span>
</pre></div>
<div class="message"><pre class="knitr r">## Using tissue as id variables
</pre></div>
</div><div class="rimage center"><img src="figure/3-3-Evaluation-IndividiualProteins-Rhtmlauto-report-18.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div></div>

  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r">    <span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 3.1.2 (2014-10-31)
## Platform: x86_64-unknown-linux-gnu (64-bit)
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8       
##  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
## [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] doMC_1.3.3        iterators_1.0.7   caret_6.0-47      lattice_0.20-31  
##  [5] robustbase_0.92-4 glmnet_2.0-2      foreach_1.4.2     Matrix_1.2-1     
##  [9] ggplot2_1.0.1     reshape_0.8.5     gdata_2.16.1     
## 
## loaded via a namespace (and not attached):
##  [1] BradleyTerry2_1.0-6 brglm_0.5-9         car_2.0-25          codetools_0.2-11   
##  [5] colorspace_1.2-6    DEoptimR_1.0-2      digest_0.6.8        evaluate_0.7       
##  [9] formatR_1.2         grid_3.1.2          gtable_0.1.2        gtools_3.5.0       
## [13] highr_0.5           knitr_1.10.5        labeling_0.3        lme4_1.1-8         
## [17] magrittr_1.5        MASS_7.3-41         mgcv_1.8-6          minqa_1.2.4        
## [21] munsell_0.4.2       nlme_3.1-120        nloptr_1.0.4        nnet_7.3-9         
## [25] pbkrtest_0.4-2      plyr_1.8.3          proto_0.3-10        quantreg_5.11      
## [29] Rcpp_0.11.6         reshape2_1.4.1      scales_0.2.5        SparseM_1.6        
## [33] splines_3.1.2       stringi_0.4-1       stringr_1.0.0       tools_3.1.2
</pre></div>
<div class="source"><pre class="knitr r">    <span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;2015-07-08 15:04:14 PDT&quot;
</pre></div>
</div></div>


</body>
</html>
